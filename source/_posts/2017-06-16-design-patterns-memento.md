---
title: 备忘录模式
date: 2017-06-16
tags: 设计模式
categories: work
---

#### 定义 ####

备忘录模式(Memento Pattern):在不破坏封装的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态，这样可以在以后将对象恢复到原先保存的状态。这是一种对象行为型模式，别名为Token。

在软件开发中，我们经常需要使用聚合对象来存储一系列数据。聚合对象用于两个职责：一是存数据；二是取数据。从依赖性来看，前者是聚合对象的基本职责；而后者既是可变化的，又是可分离的。因此，可以将遍历数据的行为从聚合对象中分离出来，封装在一个被称之为“迭代器”的对象中，由迭代器来提供遍历聚合对象内部数据的行为，这将简化聚合对象的设计，更符合“单一职责”的要求。
 
#### 模式结构 ####

- Iterator(抽象迭代器):它定义了访问和遍历元素的接口，声明了用于遍历数据元素的方法。
- ConcreteIterator(具体迭代器):迭代器的具体实现类。通过游标来记录在聚合对象中所处的位置。
- Aggregate(抽象聚合类):存储和管理元素对象，createIterator()方法充当了抽象迭代器工厂角色。
- ConcreteAggregate(具体聚合类):具体实现类。
 
![类图](/images/iterator_pattern_class_diagram.png)

#### 代码 ####

[GitHub](https://github.com/xusx1024/DesignPatternDemoCode/tree/master/IteratorPattern)

#### 分析 ####

迭代器和聚合类是密不可分的，所以大多数语言在实现容器的同时都提供了迭代器，所以我想说的是：这些语言提供的容器和迭代器大多数情况下可以满足需要的。同样的，如果我们需要自定义容器，那么我们一定要提供迭代器。

##### 优点 #####

- 更换聚合类非常方便
- 支持以不同方式遍历一个聚合类，更换迭代器即可

##### 缺点 #####

- 迭代器的设计难度较大，尤其是扩展
- 对于比较简单的遍历，迭代器有些繁琐，比如我们平时用for代替Iterator遍历一个数组

