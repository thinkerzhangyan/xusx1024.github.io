---
title: 访问者模式
date: 2017-06-20
tags: 设计模式
categories: work
---

#### 定义 ####

访问者模式(Visitor Pattern):提供一个作用于某对象结构中的各元素的操作表示，它使我们可以在不改变各元素的类的前提下定义作用于这些元素的新操作。访问模式是一种对象行为型模式。
  
#### 模式结构 ####

- Visitor：抽象访问者，声明了一个或者多个方法操作，形成所有的具体访问者角色必须实现的接口
- ConcreteVisitor：具体访问者，实现抽象访问者所声明的接口，也就是抽象访问者所声明的各个访问操作
- Node：抽象节点，声明一个接受操作，接受一个访问者对象作为一个参数
- ConcreteNode：具体节点，实现了抽象节点所规定的接受操作
- ObjectStructure：结构对象，可以遍历结构中的所有元素，如果需要，提供一个高层次的接口让访问者对象可以访问每一个元素；如果需要，可以设计成一个复合对象或者一个聚集，如List或Set
 
![类图](/images/visitor_pattern_class_diagram.png)

#### 时序图 ####

![时序图](/images/visitor_pattern_sequence_diagram.png)

#### 代码 ####
	
[GitHub](https://github.com/xusx1024/DesignPatternDemoCode/tree/master/VisitorPattern)

#### 分析 ####

个人理解，这是个多对多的关系。每个访问者可以封装固定的操作去访问所有的节点。每个节点都有被访问时相应调用的方法。
对象构造管理访问者和节点
客户端传给对象构造不同的访问者，然后得到数据。
客户端只需要关心自己提供对应的访问者，可以使用工厂生产，不必关心具体细节。

##### 优点 #####

- 增加新的访问操作很方便
- 将访问行为集中到访问者中，而不是分散在一个个元素类，职责明确
- 让用户在不修改现有元素类层次结构的情况下，定义作用于该层次结构的操作

##### 缺点 #####

-  增加新的元素节点很困难。每一次增加，都要在抽象访问者中增加新的抽象操作。
-  访问者模式要求访问者对象访问并调用每一个元素对象的操作，这意味着元素对象需要暴露自己的内部操作和内部状态，否则访问者无法访问

 
 

